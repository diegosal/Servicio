USE RMDVCore;

CREATE TABLE CatTypeUser (

Id 						INT(10) UNSIGNED NOT NULL,
TypeUser 				VARCHAR(100) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE CatTypeUser
ADD CONSTRAINT PK_TypeUser PRIMARY KEY CLUSTERED (Id);

ALTER TABLE CatTypeUser 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatTypeCommittee (

Id 						INT(10) UNSIGNED NOT NULL,
TypeCommittee 			VARCHAR(100) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE CatTypeCommittee
ADD CONSTRAINT PK_TypeCommittee PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatTypeCommittee 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatTypeVisit (

Id 					INT(10) UNSIGNED NOT NULL,
TypeVisit 			VARCHAR(255) NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate 	DATETIME NOT NULL,
Active 				BIT NOT NULL

);

ALTER TABLE CatTypeVisit
ADD CONSTRAINT PK_TypeVisit PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatTypeVisit 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatRecreationalArea (

Id 					INT(10) UNSIGNED NOT NULL,
AreaName 			VARCHAR(255) NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate 	DATETIME NOT NULL,
Active 				BIT NOT NULL

);

ALTER TABLE CatRecreationalArea
ADD CONSTRAINT PK_RecreationalArea PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatRecreationalArea 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatEventuality (

Id 						INT(10) UNSIGNED NOT NULL,
EventualityName 		VARCHAR(255) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE CatEventuality
ADD CONSTRAINT PK_Eventuality PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatEventuality 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatStatus (

Id 					INT(10) UNSIGNED NOT NULL,
StatusName 			VARCHAR(255) NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate 	DATETIME NOT NULL,
Active 				BIT NOT NULL

);

ALTER TABLE CatStatus
ADD CONSTRAINT PK_Status PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatStatus 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE CatSupplier (

Id 						INT(10) UNSIGNED NOT NULL,
SupplierName			VARCHAR(255) NOT NULL,
ContactNumer			VARCHAR(255) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE CatSupplier
ADD CONSTRAINT PK_Supplier PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CatSupplier 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE Company (

Id 						INT(10) UNSIGNED NOT NULL,
CompanyName 			VARCHAR(255) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE Company
ADD CONSTRAINT PK_Company PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE Company 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

CREATE TABLE User (

Id 					INT(10) UNSIGNED NOT NULL,
CompanyId 			INT(10) UNSIGNED NOT NULL,
TypeId 				INT(10) UNSIGNED NOT NULL,
UserName 			VARCHAR(150) NOT NULL,
UserMiddleName 		VARCHAR(150) NOT NULL,
UserLastName 		VARCHAR(150) NOT NULL,
UserMotherName 		VARCHAR(150) NOT NULL,
Email 				VARCHAR(255) NOT NULL,
PassWord 			VARCHAR(12) NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate 	DATETIME NOT NULL,
Active 				BIT NOT NULL

);

ALTER TABLE User
ADD CONSTRAINT PK_User PRIMARY KEY CLUSTERED (Id);

ALTER TABLE User 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE User
ADD CONSTRAINT FK_Company
FOREIGN KEY (CompanyId) REFERENCES Company(Id); 

ALTER TABLE User
ADD CONSTRAINT FK_TypeUser
FOREIGN KEY (TypeId) REFERENCES CatTypeUser(Id);  

/*POSIBLE ELIMINACION NO LE VEO FUNCCION
CREATE TABLE Resident (

Id 						INT(10) UNSIGNED NOT NULL,
UserId 					INT NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);*/

CREATE TABLE Vehicle (

Id 						INT(10) UNSIGNED NOT NULL,
UserId 					INT(10) UNSIGNED NOT NULL,
Plates 					VARCHAR(50) NOT NULL,
Model 					VARCHAR(255) NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE Vehicle
ADD CONSTRAINT PK_Vehicle PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE Vehicle 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Vehicle
ADD CONSTRAINT FK_Vehicle_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

CREATE TABLE Address ( 

Id 					INT(10) UNSIGNED NOT NULL,
UserId 				INT(10) UNSIGNED NOT NULL,
StreetName 			VARCHAR(255) NOT NULL,
Number 				VARCHAR(10) NOT NULL,
PostalCode 			VARCHAR(10) NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate 	DATETIME NOT NULL,
Active 				BIT NOT NULL

);

ALTER TABLE Address
ADD CONSTRAINT PK_Address PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE Vehicle 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Address
ADD CONSTRAINT FK_Address_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

CREATE TABLE CommitteeMember ( 

Id 						INT(10) UNSIGNED NOT NULL,
UserId 					INT(10) UNSIGNED NOT NULL,
CommitteeTypeId 		INT(10) UNSIGNED NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL,
Active 					BIT NOT NULL

);

ALTER TABLE CommitteeMember
ADD CONSTRAINT PK_Committee PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE CommitteeMember 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE CommitteeMember
ADD CONSTRAINT FK_Committee_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

ALTER TABLE CommitteeMember
ADD CONSTRAINT FK_TypeComittee
FOREIGN KEY (CommitteeTypeId) REFERENCES CatTypeCommittee(Id); 

CREATE TABLE Event (

Id 						INT(10) UNSIGNED NOT NULL,
UserId 					INT(10) UNSIGNED NOT NULL,
RecreationalAreaId 		INT(10) UNSIGNED NOT NULL,
StartDate 				DATETIME NOT NULL,
EndDate 				DATETIME NOT NULL,
Status 					BIT NOT NULL,
CreationDate 			DATETIME NOT NULL,
ModificationDate 		DATETIME NOT NULL

);

ALTER TABLE Event
ADD CONSTRAINT PK_Event PRIMARY KEY CLUSTERED (Id);

ALTER TABLE Event 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Event
ADD CONSTRAINT FK_Event_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

ALTER TABLE Event
ADD CONSTRAINT FK_RecreationalArea
FOREIGN KEY (RecreationalAreaId) REFERENCES CatRecreationalArea(Id); 

CREATE TABLE Ticket (

Id 					INT(10) UNSIGNED NOT NULL,
UserId 				INT(10) UNSIGNED NOT NULL,
EventualityId 		INT(10) UNSIGNED NOT NULL,
StatusId 			INT(10) UNSIGNED NOT NULL,
CreationDate 		DATETIME NOT NULL,
ModificationDate	DATETIME NOT NULL

);

ALTER TABLE Ticket
ADD CONSTRAINT PK_Ticket PRIMARY KEY CLUSTERED (Id);

ALTER TABLE Ticket 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Ticket
ADD CONSTRAINT FK_Ticket_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

ALTER TABLE Ticket
ADD CONSTRAINT FK_Eventuality
FOREIGN KEY (EventualityId) REFERENCES CatEventuality(Id);

ALTER TABLE Ticket
ADD CONSTRAINT FK_Status
FOREIGN KEY (StatusId) REFERENCES CatStatus(Id);    

CREATE TABLE Visit (

Id 					INT(10) UNSIGNED NOT NULL,
VisitId 			INT(10) UNSIGNED NOT NULL,
UserId 				INT(10) UNSIGNED NOT NULL,
CheckIn				DATETIME NOT NULL,
CheckOut 			DATETIME NOT NULL,
VisitName 			VARCHAR(150) NOT NULL,
Carnet				VARCHAR(250) NOT NULL,
Plates				VARCHAR(50) NOT NULL,
CreationDate 		DATETIME NOT NULL

);

ALTER TABLE Visit
ADD CONSTRAINT PK_Visit PRIMARY KEY CLUSTERED (Id);

ALTER TABLE Visit 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Visit
ADD CONSTRAINT FK_Visit_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

ALTER TABLE Visit
ADD CONSTRAINT FK_Visit
FOREIGN KEY (VisitId) REFERENCES CatTypeVisit(Id); 

CREATE TABLE AssistControl (

Id 					INT(10) UNSIGNED NOT NULL,
UserId 				INT(10) UNSIGNED NOT NULL,
CheckIn				DATETIME NOT NULL,
CheckOut 			DATETIME NOT NULL

);

ALTER TABLE AssistControl
ADD CONSTRAINT PK_AssistControl PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE AssistControl 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE AssistControl
ADD CONSTRAINT FK_Assist_User
FOREIGN KEY (UserId) REFERENCES User(Id); 


CREATE TABLE Payment (

Id 						INT(10) UNSIGNED NOT NULL,
UserId 					INT(10) UNSIGNED NOT NULL,
Amount                  Numeric(18,0) NOT NULL,
PaymentStatus			BIT NOT NULL,
PaymentDate				DATETIME NOT NULL

);

ALTER TABLE Payment
ADD CONSTRAINT PK_Payment PRIMARY KEY CLUSTERED (Id); 

ALTER TABLE Payment 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE Payment
ADD CONSTRAINT FK_Payment_User
FOREIGN KEY (UserId) REFERENCES User(Id); 

CREATE TABLE InternalBox (

Amount					Numeric(18,0) NOT NULL, 
CreationDate 			DATETIME NOT NULL

);

ALTER TABLE InternalBox
ADD CONSTRAINT PK_InternalBox PRIMARY KEY (Amount, CreationDate); 


CREATE TABLE InternalExpense (

Id 					INT(10) UNSIGNED NOT NULL,
UserId 				INT(10) UNSIGNED NOT NULL,
Amount				Numeric(18,0) NOT NULL,
CreationDate 		DATETIME NOT NULL

);

ALTER TABLE InternalExpense
ADD CONSTRAINT PK_InternalExpense PRIMARY KEY CLUSTERED (Id);

ALTER TABLE InternalExpense 
CHANGE Id Id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT;

ALTER TABLE InternalExpense
ADD CONSTRAINT FK_Expense_User
FOREIGN KEY (UserId) REFERENCES User(Id); 